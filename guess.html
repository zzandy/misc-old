<!DOCTYPE html>
<html id="doc" lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
</head>

<body>
    <script type="text/javascript">
        "use strict";

        const triangles = [[1, 3, 4], [3, 5, 6], [6, 7, 10], [4, 7, 8], [2, 8, 11], [0, 1, 2], [0, 5, 9], [9, 10, 11]];
        const squares = [[0, 1, 3, 5], [3, 4, 6, 7], [1, 2, 4, 8], [7, 8, 10, 11], [5, 6, 9, 10], [0, 2, 9, 11]];

        const pairs = [7, 10, 6, 11, 9, 8];

        function isum(values, indices) {
            return indices.reduce((a, i) => a + values[i], 0);
        }

        const options = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];

        function pickEx(prom, n, prefix, rest, cb) {
            if (prefix.length == n) prom.p = prom.p.then(() => cb(prefix));
            else if (prefix.length < n) {
                for (let i = 0; i < rest.length; ++i) {
                    prom.p = prom.p.then(() => pickEx(prom, n, prefix.concat(rest[i]), rest.slice(i + 1), cb));
                }
            }
        }

        function pick(n, options, cb) {
            let prom = { p: Promise.resolve() };

            pickEx(prom, n, [], options, cb);
        }

        function combEx(prom, prefix, rest, cb) {
            if (rest.length == 0) cb(prefix);

            for (let i = 0; i < rest.length; ++i) {
                const p = prefix.concat(rest[i]);
                const r = rest.concat();
                r.splice(i, 1);
                prom.p = prom.p.then(() => combEx(prom, p, r, cb))
            }
        }

        function comb(values, cb) {
            let prom = { p: Promise.resolve() };

            combEx(prom, [], values, cb);
        }

        pick(5, options, (a) => {
            comb(a, (seed) => {
                // [0] is always 1;
                seed.unshift(1);
                const test = new Array(12);

                for (let i = 0; i < pairs.length; ++i) {
                    test[i] = seed[i];
                    test[pairs[i]] = 13 - seed[i];


                    for (let j = 0; j < i; ++j)if (13 - seed[i] == test[j]) return;
                }

                if (triangles.map(t => isum(test, t)).every((s, i) => s == 20 || s == 19))
                    console.log(test, triangles.map(t => isum(test, t)), squares.map(t => isum(test, t)).map(x => x == 25 ? '###' : x == 26 ? 'OOO' : 'ZZZ').join(''));
            });
        });
    </script>
</body>

</html>