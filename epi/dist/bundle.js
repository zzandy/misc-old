!function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";function s(t,e){return"number"==typeof e&&"number"==typeof t?Math.floor(t+Math.random()*(e-t)):"number"==typeof t?Math.floor(t*Math.random()):t instanceof Array?t[Math.floor(t.length*Math.random())]:Math.random()}Object.defineProperty(e,"__esModule",{value:!0}),e.shuffle=e.array=e.rnd=void 0,e.rnd=s,e.array=function(t,e,n){const s=[];for(let r=0;r<e;++r){const e=[];for(let s=0;s<t;++s)e.push(n(r,s));s.push(e)}return s},e.shuffle=function(t){for(let e=t.length-1;e>0;--e){const n=s(e+1);[t[e],t[n]]=[t[n],t[e]]}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=e.newRandomVector=e.Point=void 0;const s=n(0),r=2*Math.PI,i=Math.sin,o=Math.cos;Math.min,Math.max;class a{constructor(t,e){this.x=t,this.y=e}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}add(t){return new a(this.x+t.x,this.y+t.y)}to(t){return new c(t.x-this.x,t.y-this.y)}clamp(t,e){const n=this.x-t[0],s=t[1]-t[0],r=this.y-e[0],i=e[1]-e[0];return new a(t[0]+(n+10*s)%s,e[0]+(r+10*i)%i)}}e.Point=a,e.newRandomVector=function(t){const e=s.rnd(r);return new c(t*o(e),t*i(e))};class c{constructor(t,e){this.x=t,this.y=e}add(t){return new c(this.x+t.x,this.y+t.y)}times(t){return new c(this.x*t,this.y*t)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get norm(){const t=this.length;return this.times(1/t)}}e.Vector=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=n(3),r=n(0),i=n(4),o=n(6),a=n(1),c=n(7),u=1024,h=.5/Math.sqrt(u),l=1.2*h;new s.Loop(1e3/24,(function(){return{render:new i.Render,repulsionIntensity:.005,repulsionRange:l,contagionRange:h,agents:r.array(u,1,(t,e)=>{const n=0|Math.sqrt(u),s=(e%n+.5)/n,i=(.5+(e/n|0))/n,c=s-.5,h=i-.5;return new o.Agent(new a.Point(s,i),a.newRandomVector(.001),c*c+h*h<.01?.1+r.rnd(10):0)})[0]}}),(function(t,e){const n=new c.QuadTree(0,0,1.01,1.01),s=Math.max(e.contagionRange,e.repulsionRange);e.agents.forEach(t=>n.add(t));const i=e.agents.map(t=>n.get(new c.AABB(t.x-s,t.y-s,2*s,2*s)).reduce((n,s)=>{if(s==t)return n;const i=s.pos.to(t.pos);0==t.progress&&s.progress>0&&i.length<e.contagionRange&&r.rnd()<.1&&(t.progress=.1);const o=(e.repulsionRange-i.length)/e.repulsionRange;return n.add(i.norm.times(o*o*e.repulsionIntensity)).norm.times(.001)},t.vector));return e.agents.forEach((e,n)=>{e.progress>0&&e.progress<100&&(e.progress+=10*t/1e3),e.move(i[n])}),e}),(function(t,e){e.render.draw(e.agents)})).start()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Loop=void 0;e.Loop=class{constructor(t,e,n,s){this.fixedDelta=t,this.init=e,this.fixed=n,this.variable=s,this.isRunning=!1,this.fixedAccum=0}start(){if(this.isRunning)return;let t=this.init();this.isRunning=!0;let e=0;const n=s=>{const r=0==e,i=r?0:s-e;e=s,t=this.update(i,t,r),this.isRunning&&requestAnimationFrame(n)};requestAnimationFrame(n)}stop(){this.isRunning=!1}update(t,e,n=!1){let s=e;this.fixedAccum+=t;let r=!1;if(n)s=this.fixed(this.fixedDelta,s),r=!0;else for(;this.fixedAccum>this.fixedDelta;)this.fixedAccum-=this.fixedDelta,s=this.fixed(this.fixedDelta,s),r=!0;return r&&this.variable(t,s),s}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Render=void 0;const s=n(5),r=n(1);e.Render=class{constructor(){const t=this.ctx=s.fullscreenCanvas();t.strokeStyle=t.fillStyle="#aaa",this.padding=new r.Vector(20,20),this.size=Math.min(t.canvas.width-2*this.padding.x,t.canvas.height-2*this.padding.y)}draw(t){const e=this.ctx;e.clearRect(0,0,e.canvas.width,e.canvas.height),e.strokeRect(this.padding.x,this.padding.y,this.size,this.size);for(let n of t){e.fillStyle=n.progress>100?"green":n.progress>0?"red":"#aaa";const t=n.progress>0&&n.progress<100?5:3;e.fillCircle(this.padding.x+n.pos.x*this.size,this.padding.y+n.pos.y*this.size,t)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fullscreenCanvas=e.fullscreenCanvas3d=e.getCanvas=void 0,e.getCanvas=(t=!1)=>{const e=document.createElement("canvas");return e.width=window.innerWidth,e.height=window.innerHeight,t||(e.style.position="absolute",e.style.top="0",e.style.left="0"),e},e.fullscreenCanvas3d=(t=!1)=>{const n=e.getCanvas(t),s=n.getContext("webgl");if(null==s)throw new Error("failed to get 'webgl' context");return document.body.appendChild(n),s},e.fullscreenCanvas=function(t=!1,n=!1){const s=e.getCanvas(t),r=s.getContext("2d",{alpha:!n});if(null==r)throw new Error("failed to get '2d' context");return r.clear=function(){return r.clearRect(0,0,r.canvas.width,r.canvas.height),r},r.makePath=function(t){r.beginPath(),r.moveTo(t[0],t[1]);for(var e=2;e<t.length;e+=2)r.lineTo(t[e],t[e+1]);return r.closePath(),r},r.strokeCircle=function(t,e,n){return r.beginPath(),r.arc(t,e,n,0,2*Math.PI,!0),r.closePath(),r.stroke(),r},r.fillCircle=function(t,e,n){return r.beginPath(),r.arc(t,e,n,0,2*Math.PI,!0),r.closePath(),r.fill(),r},document.body.style.margin="0",document.body.appendChild(s),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Agent=void 0;e.Agent=class{constructor(t,e,n=0){this.pos=t,this.vector=e,this.progress=n}get x(){return this.pos.x}get y(){return this.pos.y}move(t){this.vector=t,this.pos=this.pos.add(t).clamp([0,1],[0,1])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadTree=e.AABB=void 0;class s{constructor(t,e,n,s){this.x=t,this.y=e,this.w=n,this.h=s}contains(t){const{x:e,y:n,w:s,h:r}=this;return t.x>=e&&t.y>=n&&t.x<e+s&&t.y<n+r}intersects(t){const{x:e,y:n,w:s,h:r}=this;return!(e+s<t.x||n+r<t.y||t.x+t.w<e||t.y+t.h<n)}}e.AABB=s;class r extends s{constructor(){super(...arguments),this.leafs=[],this.branches=[]}add(t){if(!this.contains(t))return!1;const{leafs:e,branches:n,leafs:{length:s},branches:{length:i}}=this;if(s<4)return e.push(t),!0;if(0==i){const{x:t,y:e}=this,[s,i]=[this.w/2,this.h/2];n.push(new r(t,e,s,i),new r(t+s,e,s,i),new r(t,e+i,s,i),new r(t+s,e+i,s,i))}return n.some(e=>e.add(t))}get(t){const e=[];return this.addPoints(t,e),e}addPoints(t,e){this.intersects(t)&&(Array.prototype.push.apply(e,this.leafs.filter(e=>t.contains(e))),this.branches.forEach(n=>n.addPoints(t,e)))}}e.QuadTree=r}]);